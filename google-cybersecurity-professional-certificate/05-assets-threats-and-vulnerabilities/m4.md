- [Social engineering tactics](#social-engineering-tactics)
  - [Social engineering risks](#social-engineering-risks)
  - [Stages of social engineering](#stages-of-social-engineering)
  - [Signs of an attack](#signs-of-an-attack)
  - [Encouraging caution](#encouraging-caution)
  - [Preventing social engineering](#preventing-social-engineering)
  - [Resources for more information](#resources-for-more-information)
- [Types of phishing](#types-of-phishing)
  - [Phishing for information](#phishing-for-information)
    - [Phishing kit](#phishing-kit)
    - [Phishing kit tools](#phishing-kit-tools)
    - [Phishing security measures](#phishing-security-measures)
  - [The origins of phishing](#the-origins-of-phishing)
    - [Early persuasion tactics](#early-persuasion-tactics)
    - [How phishing has evolved](#how-phishing-has-evolved)
    - [Recent trends](#recent-trends)
    - [Resources for more information](#resources-for-more-information-1)
- [Filter malicious emails](#filter-malicious-emails)
  - [Activity Overview](#activity-overview)
  - [Scenario](#scenario)
  - [Step-By-Step Instructions](#step-by-step-instructions)
    - [Step 1: Analyze the suspicious email](#step-1-analyze-the-suspicious-email)
    - [Step 2: Examine the sender's information](#step-2-examine-the-senders-information)
    - [Step 3: Review the message body for clues](#step-3-review-the-message-body-for-clues)
    - [Step 4: Investigation the download options](#step-4-investigation-the-download-options)
    - [Answers](#answers)
- [An introduction to malware](#an-introduction-to-malware)
  - [Virus](#virus)
  - [Worm](#worm)
  - [Trojan](#trojan)
  - [Adware](#adware)
  - [Spyware](#spyware)
  - [Scareware](#scareware)
  - [Fileless malware](#fileless-malware)
  - [Rootkits](#rootkits)
  - [Botnet](#botnet)
  - [Ransomware](#ransomware)
  - [Cryptojacking](#cryptojacking)
    - [Signs of cryptojacking](#signs-of-cryptojacking)
- [Web-based exploits](#web-based-exploits)
  - [Cross-site scripting (XSS)](#cross-site-scripting-xss)
    - [Types of cross-site scripting attacks](#types-of-cross-site-scripting-attacks)
- [Prevent injection attacks](#prevent-injection-attacks)
  - [SQL queries](#sql-queries)
  - [SQL injection categories](#sql-injection-categories)
    - [In-band SQL injection](#in-band-sql-injection)
    - [Out-of-band SQL injection](#out-of-band-sql-injection)
    - [Inferential SQL injection](#inferential-sql-injection)
  - [Injection Prevention](#injection-prevention)
- [Traits of an effective threat model](#traits-of-an-effective-threat-model)
  - [Why application security matters](#why-application-security-matters)
  - [Defending the application layer](#defending-the-application-layer)
  - [Common frameworks](#common-frameworks)
    - [STRIDE](#stride)
    - [PASTA](#pasta)
    - [Trike](#trike)
    - [VAST](#vast)
  - [Participating in threat modeling](#participating-in-threat-modeling)
- [Apply the PASTA threat model framework](#apply-the-pasta-threat-model-framework)
  - [Activity Overview](#activity-overview-1)
  - [Scenario](#scenario-1)
  - [Step-By-Step Instructions](#step-by-step-instructions-1)
    - [Part 1 - Access the resources](#part-1---access-the-resources)
      - [Step 1: Access the templates](#step-1-access-the-templates)
      - [Step 2: Access supporting materials](#step-2-access-supporting-materials)
    - [Part 2 - Complete the PASTA stages](#part-2---complete-the-pasta-stages)
      - [Step 1: Identify the mobile app's business objectives](#step-1-identify-the-mobile-apps-business-objectives)
      - [Step 2: Evaluate the apps components](#step-2-evaluate-the-apps-components)
      - [Step 3: Review a data flow diagram](#step-3-review-a-data-flow-diagram)
      - [Step 4: Use an attacker mindset to analyze potential threats](#step-4-use-an-attacker-mindset-to-analyze-potential-threats)
      - [Step 5: List vulnerabilities that can be exploited by those threats](#step-5-list-vulnerabilities-that-can-be-exploited-by-those-threats)
      - [Step 6: Map assets, threats, and vulnerabilities to an attack tree](#step-6-map-assets-threats-and-vulnerabilities-to-an-attack-tree)
      - [Step 7: Identify new security controls that can reduce risk](#step-7-identify-new-security-controls-that-can-reduce-risk)
    - [What to Include in Your Response](#what-to-include-in-your-response)
  - [Activity Exemplar](#activity-exemplar)
      - [Stage I: Define business and security objectives](#stage-i-define-business-and-security-objectives)
      - [Stage II: Define the technical scope](#stage-ii-define-the-technical-scope)
      - [Stage III: Decompose the application](#stage-iii-decompose-the-application)
      - [Stage IV: Threat analysis](#stage-iv-threat-analysis)
      - [Stage V: Vulnerability analysis](#stage-v-vulnerability-analysis)
      - [Stage VI: Attack modeling](#stage-vi-attack-modeling)
      - [Stage VII: Risk analysis and impact](#stage-vii-risk-analysis-and-impact)
- [Quiz: Module 4 Challenge](#quiz-module-4-challenge)
  - [Questions](#questions)
  - [Answers](#answers-1)

# Social engineering tactics

Social engineering attacks are a popular choice among threat actors. That’s because it’s often easier to trick people into providing them with access, information, or money than it is to exploit a software or network vulnerability.

## Social engineering risks

Social engineering is a form of deception that takes advantage of the way people think. It preys on people’s natural feelings of curiosity, generosity, and excitement. Threat actors turn those feelings against their targets by affecting their better judgment. Social engineering attacks can be incredibly harmful because of how easy they can be to accomplish.

One of the highest-profile social engineering attacks that occurred in recent years was the [Twitter Hack of 2020](https://www.dfs.ny.gov/Twitter_Report). During that incident, a group of hackers made phone calls to Twitter employees pretending to be from the IT department. Using this basic scam, the group managed to gain access to the organization’s network and internal tools. This allowed them to take over the accounts of high-profile users, including politicians, celebrities, and entrepreneurs.

Attacks like this are just one example of the chaos threat actors can create using basic social engineering techniques. These attacks present serious risks because they don’t require sophisticated computer skills to perform. Defending against them requires a multi-layered approach that combines technological controls with user awareness.

## Stages of social engineering

1. Prepare
2. Establish trust
3. Use persuasion tactics
4. Disconnect from the target

## Signs of an attack

Oftentimes, people are unable to tell that an attack is happening until it's too late. Social engineering is such a dangerous threat because it typically allows attackers to bypass technological defenses that are in their way. Although these threats are difficult to prevent, recognizing the signs of social engineering is a key to reducing the likelihood of a successful attack.

These are common types of social engineering to watch out for:

- **Baiting** is a social engineering tactic that tempts people into compromising their security. A common example is USB baiting that relies on someone finding an infected USB drive and plugging it into their device.
- **Phishing** is the use of digital communications to trick people into revealing sensitive data or deploying malicious software. It is one of the most common forms of social engineering, typically performed via email.
- **Quid pro quo** is a type of baiting used to trick someone into believing that they’ll be rewarded in return for sharing access, information, or money. For example, an attacker might impersonate a loan officer at a bank and call customers offering them a lower interest rate on their credit card. They'll tell the customers that they simply need to provide their account details to claim the deal.
- **Tailgating** is a social engineering tactic in which unauthorized people follow an authorized person into a restricted area. This technique is also sometimes referred to as piggybacking.
- **Watering hole** is a type of attack when a threat actor compromises a website frequently visited by a specific group of users. Oftentimes, these watering hole sites are infected with malicious software. An example is the Holy Water attack of 2020 that infected various religious, charity, and volunteer websites.

Attackers might use any of these techniques to gain unauthorized access to an organization. Everyone is vulnerable to them, from entry-level employees to senior executives. However, you can reduce the risks of social engineering attacks at any business by teaching others what to expect.

## Encouraging caution

Spreading awareness usually starts with comprehensive security training. When it comes to social engineering, there are three main areas to focus on when teaching others:

- **Stay alert** of suspicious communications and unknown people, especially when it comes to email. For example, look out for spelling errors and double-check the sender's name and email address.
- **Be cautious** about sharing information, especially over social media. Threat actors often search these platforms for any information they can use to their advantage.
- **Control curiosity** when something seems too good to be true. This can include wanting to click on attachments or links in emails and advertisements.

**Pro tip**: Implementing technologies like firewalls, multi-factor authentication (MFA), block lists, email filtering, and others helps layers the defenses should someone make a mistake.

Ideally, security training extends beyond employees. Educating customers about social engineering threats is also a key to mitigating these threats. And security analysts play an important part in promoting safe practices. For example, a big part of an analyst's job is testing systems and documenting best practices for others at an organization to follow.

## Preventing social engineering

- Implementing managerial controls
- Staying informed of trends
- Sharing your knowledge with others

## Resources for more information

Here are two additional resources to review that will help you continue developing your understanding of social engineering trends and security practices:

- [OUCH!](https://www.sans.org/newsletters/ouch/) is a free monthly newsletter from the SANS Institute that reports on social engineering trends and other security topics.
- [Scamwatch](https://www.scamwatch.gov.au/) is a resource for news and tools for recognizing, avoiding, and reporting social engineering scams.

# Types of phishing

Phishing is one of the most common types of **social engineering**, which are manipulation techniques that exploit human error to gain private information, access, or valuables. Previously, you learned how **phishing** is the use of digital communications to trick people into revealing sensitive data or deploying malicious software.

## Phishing for information

### Phishing kit

**Phishing kit** is a collection of software tools needed to launch a phishing campaign.

### Phishing kit tools

- Malicious attachments
- Fake data-collection forms
- Fraudulent web links

### Phishing security measures

- Anti-phishing policies
- Employee training resources
- Email filters
- Intrusion prevention systems

## The origins of phishing

Phishing has been around since the early days of the internet. It can be traced back to the 1990s. At the time, people across the world were coming online for the first time. As the internet became more accessible it began to attract the attention of malicious actors. These malicious actors realized that the internet gave them a level of anonymity to commit their crimes.

### Early persuasion tactics

One of the earliest instances of phishing was aimed at a popular chat service called AOL Instant Messenger (AIM). Users of the service began receiving emails asking them to verify their accounts or provide personal billing information. The users were unaware that these messages were sent by malicious actors pretending to be service providers.

This was one of the first examples of mass phishing, which describes attacks that send malicious emails out to a large number of people, increasing the likelihood of baiting someone into the trap.

During the AIM attacks, malicious actors carefully crafted emails that appeared to come directly from AOL. The messages used official logos, colors, and fonts to trick unsuspecting users into sharing their information and account details.

Attackers used the stolen information to create fraudulent AOL accounts they could use to carry out other crimes anonymously. AOL was forced to adapt their security policies to address these threats. The chat service began including messages on their platforms to warn users about phishing attacks.

### How phishing has evolved

Phishing continued evolving at the turn of the century as businesses and newer technologies began entering the digital landscape. In the early 2000s, e-commerce and online payment systems started to become popular alternatives to traditional marketplaces. The introduction of online transactions presented new opportunities for attackers to commit crimes.

A number of techniques began to appear around this time period, many of which are still used today. There are five common types of phishing that every security analyst should know:

- **Email phishing** is a type of attack sent via email in which threat actors send messages pretending to be a trusted person or entity.
- **Smishing** is a type of phishing that uses Short Message Service (SMS), a technology that powers text messaging. Smishing covers all forms of text messaging services, including Apple’s iMessages, WhatsApp, and other chat mediums on phones.
- **Vishing** refers to the use of voice calls or voice messages to trick targets into providing personal information over the phone.
- **Spear phishing** is a subset of email phishing in which specific people are purposefully targeted, such as the accountants of a small business.
- **Whaling** refers to a category of spear phishing attempts that are aimed at high-ranking executives in an organization.

Since the early days of phishing, email attacks remain the most common types that are used. While they were originally used to trick people into sharing access credentials and credit card information, email phishing became a popular method to infect computer systems and networks with malicious software.

In late 2003, attackers around the world created fraudulent websites that resembled businesses like eBay and PayPal™. Mass phishing campaigns to distribute malicious programs were also launched against e-commerce and banking sites.

### Recent trends

Starting in the 2010s, attackers began to shift away from mass phishing attempts that relied on baiting unsuspecting people into a trap. Leveraging new technologies, criminals began carrying out what’s known as targeted phishing attempts. Targeted phishing describes attacks that are sent to specific targets using highly customized methods to create a strong sense of familiarity.

A type of targeted phishing that evolved in the 2010s is angler phishing. **Angler phishing** is a technique where attackers impersonate customer service representatives on social media. This tactic evolved from people’s tendency to complain about businesses online. Threat actors intercept complaints from places like message boards or comment sections and contact the angry customer via social media. Like the AIM attacks of the 1990s, they use fraudulent accounts that appear similar to those of actual businesses. They then trick the angry customers into sharing sensitive information with the promise of fixing their problem.

### Resources for more information

Staying up-to-date on phishing threats is one of the best things you can do to educate yourself and help your organization make smarter security decisions.

- [Google’s phishing quiz](https://phishingquiz.withgoogle.com/) is a tool that you can use or share that illustrates just how difficult it can be to identify these attacks.
- [Phishing.org](https://www.phishing.org/) reports on the latest phishing trends and shares free resources that can help reduce phishing attacks.
- [The Anti-Phishing Working Group (APWG)](https://apwg.org/) is a non-profit group of multidisciplinary security experts that publishes a quarterly report on phishing trends.

# Filter malicious emails

## Activity Overview

In this activity, you will analyze a suspicious email and identify signs of a phishing attack. Then, you will determine whether the email should be allowed or quarantined.

Phishing is one of the most common and dangerous forms of social engineering that you’ll encounter in the field. Identifying phishing attempts will help you prevent threats and find ways to improve security procedures.

## Scenario

Review the scenario below. Then complete the step-by-step instructions.

You’re a security analyst at an investment firm called Imaginary Bank. An executive at the firm recently received a spear phishing email that appears to come from the board of Imaginary Bank. **Spear phishing** is a malicious email attack targeting a specific user or group of users, appearing to originate from a trusted source. In this case, the executive is being asked to install new collaboration software, ExecuTalk.

The executive suspects this email might be a phishing attempt because ExecuTalk was never mentioned during the last board meeting. They've forwarded the message to your team to verify if it’s legitimate. Your supervisor has tasked you with investigating the message and determining whether it should be quarantined.

## Step-By-Step Instructions

Follow the instructions and answer the questions below to complete the activity.

### Step 1: Analyze the suspicious email

Previously, you learned that phishing is a type of social engineering. Threat actors who send malicious emails rely on deception and manipulation techniques to trick their targets. When investigating suspicious emails like this, it's a good idea to note the threat actor's tactics. You can use that information to alert others at your organization about similar messages they might receive and what to watch out for.

Start your investigation by analyzing the suspicious message. Try to identify clues that this is a phishing attack against this executive at Imaginary Bank:

```
From: imaginarybank@gmail.org

Sent: Saturday, December 21, 2019  15:05:05

To: cfo@imaginarybank.com

Subject:  RE: You are been added to an ecsecutiv's groups

Conglaturations! You have been added to a collaboration group ‘Execs.’

Downlode ExecuTalk to your computer.

Mac® | Windows® | Android™

You're team needs you! This invitation will expire in 48 hours so act quickly.

Sincerely,

ExecuTalk©

All rights reserved.
```

### Step 2: Examine the sender's information

Next, examine the major parts of this message in closer detail starting with the email header. You can often find clues in the message header that indicate you are dealing with a phishing attack.

Examine the email header of this suspicious message:

```
From: imaginarybank@gmail.org

Sent: Saturday, December 21, 2019  15:05:05

To: cfo@imaginarybank.com

Subject:  RE: You are been added to an ecsecutiv's groups
```

**Pro tip**: Always check the domain name that comes after the @ symbol. Requests for sensitive information or asking you to download files should not come from personal accounts, like @gmail.com, @icloud, @yahoo.com or others.

- Which two clues in the message header indicate to you that this is a phishing attempt? Select two answers.
- The time stamp goes beyond 12 PM.
- There is a misspelling in the subject line.
- The subject line appears to be a reply.
- The sender is using a different domain.

### Step 3: Review the message body for clues

Next, review the body of the message received by the executive at Imaginary Bank. Try to identify three ways this threat actor tried to disguise their message as a legitimate email.

**Note**: This message is strictly meant to illustrate an example of an email that contains malicious download options.

```
Conglaturations! You have been added to a collaboration group ‘Execs.’

Downlode ExecuTalk to your computer.

Mac® | Windows® | Android™

You're team needs you! This invitation will expire in 48 hours so act quickly.

Sincerely,

ExecuTalk©

All rights reserved.
```

- What details make this message appear legitimate? Select three answers.
- The invitation time limit
- The brand labeling
- The download options for major operating systems
- The title of the group

### Step 4: Investigation the download options

Phishing emails often contain links that redirect to malicious sites or trigger malware downloads.

**Pro tip**: When investigating suspicious emails, hovering your mouse cursor over buttons will reveal the URL they redirect to without having to click them. This is the safest way to check if it will take you to a suspicious domain or if it links to an http:// URL that isn’t secure.

In this case, the message contains three download options. Each of them opens this login form:

![executalk](/google-cybersecurity-professional-certificate/05-assets-threats-and-vulnerabilities/assets/executalk.png)

- The download options open a webpage that contains a login form where someone can enter a username and password. Carefully review the webpage. What is the main clue that indicates this form is malicious?
- Branding
- The URL
- Sign-in options
- Font type
- After completing your investigation, should this email be quarantined?
- Yes
- No

### Answers

1. 2 & 4
2. 2, 3 & 4
3. 2
4. 1

# An introduction to malware

## Virus

A **virus** is malicious code written to interfere with computer operations and cause damage to data and software. This type of malware must be installed by the target user before it can spread itself and cause damage. One of the many ways that viruses are spread is through phishing campaigns where malicious links are hidden within links or attachments.

## Worm

A **worm** is malware that can duplicate and spread itself across systems on its own. Similar to a virus, a worm must be installed by the target user and can also be spread with tactics like malicious email. Given a worm's ability to spread on its own, attackers sometimes target devices, drives, or files that have shared access over a network.

A well known example is the Blaster worm, also known as Lovesan, Lovsan, or MSBlast. In the early 2000s, this worm spread itself on computers running Windows XP and Windows 2000 operating systems. It would force devices into a continuous loop of shutting down and restarting. Although it did not damage the infected devices, it was able to spread itself to hundreds of thousands of users around the world. Many variants of the Blaster worm have been deployed since the original and can infect modern computers.

**Note**: Worms were very popular attacks in the mid 2000s but are less frequently used in recent years.

## Trojan

A trojan, also called a **Trojan horse**, is malware that looks like a legitimate file or program. This characteristic relates to how trojans are spread. Similar to viruses, attackers deliver this type of malware hidden in file and application downloads. Attackers rely on tricking unsuspecting users into believing they’re downloading a harmless file, when they’re actually infecting their own device with malware that can be used to spy on them, grant access to other devices, and more.

## Adware

Advertising-supported software, or **adware**, is a type of legitimate software that is sometimes used to display digital advertisements in applications. Software developers often use adware as a way to lower their production costs or to make their products free to the public—also known as freeware or shareware. In these instances, developers monetize their product through ad revenue rather than at the expense of their users.

Malicious adware falls into a sub-category of malware known as a **potentially unwanted application (PUA)**. A PUA is a type of unwanted software that is bundled in with legitimate programs which might display ads, cause device slowdown, or install other software. Attackers sometimes hide this type of malware in freeware with insecure design to monetize ads for themselves instead of the developer. This works even when the user has declined to receive ads.

## Spyware

**Spyware** is malware that's used to gather and sell information without consent. It's also considered a PUA. Spyware is commonly hidden in bundleware, additional software that is sometimes packaged with other applications. PUAs like spyware have become a serious challenge in the open-source software development ecosystem. That’s because developers tend to overlook how their software could be misused or abused by others.

## Scareware

Another type of PUA is **scareware**. This type of malware employs tactics to frighten users into infecting their own device. Scareware tricks users by displaying fake warnings that appear to come from legitimate companies. Email and pop-ups are just a couple of ways scareware is spread. Both can be used to deliver phony warnings with false claims about the user's files or data being at risk.

## Fileless malware

**Fileless malware** does not need to be installed by the user because it uses legitimate programs that are already installed to infect a computer. This type of infection resides in memory where the malware never touches the hard drive. This is unlike the other types of malware, which are stored within a file on disk. Instead, these stealthy infections get into the operating system or hide within trusted applications.

**Pro tip**: Fileless malware is detected by performing memory analysis, which requires experience with operating systems.

## Rootkits

A **rootkit** is malware that provides remote, administrative access to a computer. Most attackers use rootkits to open a backdoor to systems, allowing them to install other forms of malware or to conduct network security attacks.

This kind of malware is often spread by a combination of two components: a dropper and a loader. A **dropper** is a type of malware that comes packed with malicious code which is delivered and installed onto a target system. For example, a dropper is often disguised as a legitimate file, such as a document, an image, or an executable to deceive its target into opening, or dropping it, onto their device. If the user opens the dropper program, its malicious code is executed and it hides itself on the target system.

Multi-staged malware attacks, where multiple packets of malicious code are deployed, commonly use a variation called a loader. A **loader** is a type of malware that downloads strains of malicious code from an external source and installs them onto a target system. Attackers might use loaders for different purposes, such as to set up another type of malware---a botnet.

## Botnet

A **botnet**, short for “robot network,” is a collection of computers infected by malware that are under the control of a single threat actor, known as the “bot-herder.” Viruses, worms, and trojans are often used to spread the initial infection and turn the devices into a bot for the bot-herder. The attacker then uses file sharing, email, or social media application protocols to create new bots and grow the botnet. When a target unknowingly opens the malicious file, the computer, or bot, reports the information back to the bot-herder, who can execute commands on the infected computer.

## Ransomware

Ransomware describes a malicious attack where threat actors encrypt an organization's data and demand payment to restore access. According to the Cybersecurity and Infrastructure Security Agency (CISA), ransomware crimes are on the rise and becoming increasingly sophisticated. Ransomware infections can cause significant damage to an organization and its customers. An example is the [WannaCry](https://en.wikipedia.org/wiki/WannaCry_ransomware_attack) attack that encrypts a victim's computer until a ransom payment of cryptocurrency is paid.

## Cryptojacking

A form of malware that installs software to illegally mine cryptocurrencies.

### Signs of cryptojacking

- Slowdown
- Increased CPU usage
- Sudden system crashes
- Fast draining batteries
- Unusually high electricity costs

# Web-based exploits

Malicious code or behavior that's used to take advantage of coding flaws in a web application.

## Cross-site scripting (XSS)

An injection attack that inserts code into a vulnerable website or web application.

### Types of cross-site scripting attacks

1. **Reflected**: An instanced when malicious script is sent to a server and activated during the server's response.
2. **Stored**: An instance when malicious script is injected directly on the server.
3. **DOM-based**: An instance when malicious script exists in the webpage a browser loads.

# Prevent injection attacks

## SQL queries

Every bit of information that’s accessed online is stored in a database. A database is an organized collection of information or data in one place. A database can include data such as an organization's employee directory or customer payment methods. In SQL, database information is organized in tables. SQL is commonly used for retrieving, inserting, updating, or deleting information in tables using queries.

A SQL query is a request for data from a database. For example, a SQL query can request data from an organization's employee directory such as employee IDs, names, and job titles. A human resources application can accept an input that queries a SQL table to filter the data and locate a specific person. SQL injections can occur anywhere within a vulnerable application that can accept a SQL query.

Queries are usually initiated in places where users can input information into an application or a website via an input field. Input fields include features that accept text input such as login forms, search bars, or comment submission boxes. A SQL injection occurs when an attacker exploits input fields that aren't programmed to filter out unwanted text. SQL injections can be used to manipulate databases, steal sensitive data, or even take control of vulnerable applications.

## SQL injection categories

There are three main categories of SQL injection:

- In-band
- Out-of-band
- Inferential

In the following sections, you'll learn that each type describes how a SQL injection is initiated and how it returns the results of the attack.

### In-band SQL injection

In-band, or classic, SQL injection is the most common type. An in-band injection is one that uses the same communication channel to launch the attack and gather the results.

For example, this might occur in the search box of a retailer's website that lets customers find products to buy. If the search box is vulnerable to injection, an attacker could enter a malicious query that would be executed in the database, causing it to return sensitive information like user passwords. The data that's returned is displayed back in the search box where the attack was initiated.

### Out-of-band SQL injection

An out-of-band injection is one that uses a different communication channel to launch the attack and gather the results.

For example, an attacker could use a malicious query to create a connection between a vulnerable website and a database they control. This separate channel would allow them to bypass any security controls that are in place on the website's server, allowing them to steal sensitive data

Note: Out-of-band injection attacks are very uncommon because they'll only work when certain features are enabled on the target server.

### Inferential SQL injection

Inferential SQL injection occurs when an attacker is unable to directly see the results of their attack. Instead, they can interpret the results by analyzing the behavior of the system.

For example, an attacker might perform a SQL injection attack on the login form of a website that causes the system to respond with an error message. Although sensitive data is not returned, the attacker can figure out the database's structure based on the error. They can then use this information to craft attacks that will give them access to sensitive data or to take control of the system.

## Injection Prevention

SQL queries are often programmed with the assumption that users will only input relevant information. For example, a login form that expects users to input their email address assumes the input will be formatted a certain way, such as jdoe@domain.com. Unfortunately, this isn’t always the case.

A key to preventing SQL injection attacks is to escape user inputs—preventing someone from inserting any code that a program isn't expecting.

There are several ways to escape user inputs:

- **Prepared statements**: a coding technique that executes SQL statements before passing them on to a database
- **Input sanitization**: programming that removes user input which could be interpreted as code.
- **Input validation**: programming that ensures user input meets a system's expectations.

Using a combination of these techniques can help prevent SQL injection attacks. In the security field, you might need to work closely with application developers to address vulnerabilities that can lead to SQL injections. [OWASP's SQL injection detection techniques](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection) is a useful resource if you're interested in investigating SQL injection vulnerabilities on your own.

# Traits of an effective threat model

**Threat modeling** is the process of identifying assets, their vulnerabilities, and how each is exposed to threats. It is a strategic approach that combines various security activities, such as vulnerability management, threat analysis, and incident response. Security teams commonly perform these exercises to ensure their systems are adequately protected. Another use of threat modeling is to proactively find ways of reducing risks to any system or business process.

## Why application security matters

Applications have become an essential part of many organizations' success. For example, web-based applications allow customers from anywhere in the world to connect with businesses, their partners, and other customers.

Mobile applications have also changed the way people access the digital world. Smartphones are often the main way that data is exchanged between users and a business. The volume of data being processed by applications makes securing them a key to reducing risk for everyone who’s connected.

For example, say an application uses Java-based logging libraries with the Log4Shell vulnerability ([CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)). If it's not patched, this vulnerability can allow remote code execution that an attacker can use to gain full access to your system from anywhere in the world. If exploited, a critical vulnerability like this can impact millions of devices.

## Defending the application layer

Defending the application layer requires proper testing to uncover weaknesses that can lead to risk. Threat modeling is one of the primary ways to ensure that an application meets security requirements. A DevSecOps team, which stands for development, security, and operations, usually performs these analyses.

A typical threat modeling process is performed in a cycle:

- Define the scope
- Identify threats
- Characterize the environment
- Analyze threats
- Mitigate risks
- Evaluate findings

![threat-modeling-steps](/google-cybersecurity-professional-certificate/05-assets-threats-and-vulnerabilities/assets/threat-modeling-steps.png)

Ideally, threat modeling should be performed before, during, and after an application is developed. However, conducting a thorough software analysis takes time and resources. Everything from the application's architecture to its business purposes should be evaluated. As a result, a number of threat-modeling frameworks have been developed over the years to make the process smoother.

**Note**: Threat modeling should be incorporated at every stage of the software development lifecycle, or SDLC.

## Common frameworks

When performing threat modeling, there are multiple methods that can be used, such as:

- STRIDE
- PASTA
- Trike
- VAST

Organizations might use any one of these to gather intelligence and make decisions to improve their security posture. Ultimately, the “right” model depends on the situation and the types of risks an application might face.

### STRIDE

**STRIDE** is a threat-modeling framework developed by Microsoft. It’s commonly used to identify vulnerabilities in six specific attack vectors. The acronym represents each of these vectors: spoofing, tampering, repudiation, information disclosure, denial of service, and elevation of privilege.

### PASTA

The **Process of Attack Simulation and Threat Analysis (PASTA)** is a risk-centric threat modeling process developed by two OWASP leaders and supported by a cybersecurity firm called VerSprite. Its main focus is to discover evidence of viable threats and represent this information as a model. PASTA's evidence-based design can be applied when threat modeling an application or the environment that supports that application. Its seven stage process consists of various activities that incorporate relevant security artifacts of the environment, like vulnerability assessment reports.

1. Define business and security objectives
2. Define the technical scope
3. Decompose the application
4. Perform a threat analysis
5. Perform a vulnerability analysis
6. Conduct attack modeling
7. Analyze risk and impact

### Trike

**Trike** is an open source methodology and tool that takes a security-centric approach to threat modeling. It's commonly used to focus on security permissions, application use cases, privilege models, and other elements that support a secure environment.

### VAST

The **Visual, Agile, and Simple Threat (VAST)** Modeling framework is part of an automated threat-modeling platform called ThreatModeler®. Many security teams opt to use VAST as a way of automating and streamlining their threat modeling assessments.

## Participating in threat modeling

Threat modeling is often performed by experienced security professionals, but it’s almost never done alone. This is especially true when it comes to securing applications. Programs are complex systems responsible for handling a lot of data and processing a variety of commands from users and other systems.

One of the keys to threat modeling is asking the right questions:

- What are we working on?
- What kinds of things can go wrong?
- What are we doing about it?
- Have we addressed everything?
- Did we do a good job?

It takes time and practice to learn how to work with things like data flow diagrams and attack trees. However, anyone can learn to be an effective threat modeler. Regardless of your level of experience, participating in one of these exercises always starts with simply asking the right questions.

**Attack tree** is a diagram that maps threats to assets.

# Apply the PASTA threat model framework

## Activity Overview

In this activity, you will practice using the Process of Attack Simulation and Threat Analysis (PASTA) threat model framework. You will determine whether a new shopping app is safe to launch.

Threat modeling is an important part of secure software development. Security teams typically perform threat models to identify vulnerabilities before malicious actors do. PASTA is a commonly used framework for assessing the risk profile of new applications.

## Scenario

Review the following scenario. Then complete the step-by-step instructions.

You’re part of the growing security team at a company for sneaker enthusiasts and collectors. The business is preparing to launch a mobile app that makes it easy for their customers to buy and sell shoes.

You are performing a threat model of the application using the PASTA framework. You will go through each of the seven stages of the framework to identify security requirements for the new sneaker company app.

## Step-By-Step Instructions

Follow the instructions and answer the included questions to complete the activity.

### Part 1 - Access the resources

#### Step 1: Access the templates

To use the template for this course item, click the following link and select Use Template.

Link to template: [PASTA worksheet](https://docs.google.com/document/d/1u3aU6ZnWfcjzwZt79OdIwJ27dcyCZYDtmEEMivey3Os/template/preview?resourcekey=0-TAMA_2t0BCj5-BL9wG23Ng)

#### Step 2: Access supporting materials

The following supporting materials will help you complete this activity. Keep them open as you proceed to the next steps.

To use the supporting materials for this course item, click the following link and select Use Template.

Link to supporting materials:

- [PASTA data flow diagram](https://docs.google.com/presentation/d/1ol7y79popTFfNHM-90ES-H-i1Lpd0YNvPShxBlXozjg/template/preview?resourcekey=0-DZAkf7Vzh2PXsP-j3oXV-g)
- [PASTA attack tree](https://docs.google.com/presentation/d/1FmWLyHgmq9XQoVuMxOym2PHO8IuedCkan4moYnI-EJ0/template/preview?resourcekey=0-zYPY7AhPJdcClXamlAfOag#slide=id.p)

### Part 2 - Complete the PASTA stages

#### Step 1: Identify the mobile app's business objectives

The main goal of Stage I of the PASTA framework is to understand why the application was developed and what it is expected to do.

**Note**: Stage I typically requires gathering input from many individuals at a business.

First, review the following description of why the sneaker company decided to develop this new app:

**Description**: Our application should seamlessly connect sellers and shoppers. It should be easy for users to sign-up, log in, and manage their accounts. Data privacy is a big concern for us. We want users to feel confident that we’re being responsible with their information.

Buyers should be able to directly message sellers with questions. They should also have the ability to rate sellers to encourage good service. Sales should be clear and quick to process. Users should have several payment options for a smooth checkout process. Proper payment handling is really important because we want to avoid legal issues.

In the **Stage 1** row of the **PASTA worksheet**, make **2-3 notes** of business objectives that you’ve identified from the description.

#### Step 2: Evaluate the apps components

In Stage II, the technological scope of the project is defined. Normally, the application development team is involved in this stage because they have the most knowledge about the code base and application logic. Your responsibility as a security professional would be to evaluate the application's architecture for security risks.

For example, the app will be exchanging and storing a lot of user data. These are some of the technologies that it uses:

- **Application programming interface (API)**: An API is a set of rules that define how software components interact with each other. In application development, third-party APIs are commonly used to add functionality without having to program it from scratch.
- **Public key infrastructure (PKI)**: PKI is an encryption framework that secures the exchange of online information. The mobile app uses a combination of symmetric and asymmetric encryption algorithms: AES and RSA. AES encryption is used to encrypt sensitive data, such as credit card information. RSA encryption is used to exchange keys between the app and a user's device.
- **SHA-256**: SHA-256 is a commonly used hash function that takes an input of any length and produces a digest of 256 bits. The sneaker app will use SHA-256 to protect sensitive user data, like passwords and credit card numbers.
- **Structured query language (SQL)**: SQL is a programming language used to create, interact with, and request information from a database. For example, the mobile app uses SQL to store information about the sneakers that are for sale, as well as the sellers who are selling them. It also uses SQL to access that data during a purchase.

Consider what you've learned about these technologies:

- Which of these technologies would you evaluate first? How might they present risks from a security perspective?

In the **Stage II** row of the **PASTA worksheet**, write **2-3 sentences** (40-60 words) that describe why you choose to prioritize that technology over the others.

#### Step 3: Review a data flow diagram

During Stage III of PASTA, the objective is to analyze how the application is handling information. Here, each process is broken down.

For example, one of the app's processes might be to allow buyers to search the database for shoes that are for sale.

Open the **PASTA data flow diagram** resource. Review the diagram and consider how the technologies you evaluated relate to protecting user data in this process.

**Note**: Software developers usually have detailed data flow diagrams available for security teams to use and verify that information is being processed securely.

#### Step 4: Use an attacker mindset to analyze potential threats

Stage IV is about identifying potential threats to the application. This includes threats to the technologies you listed in Stage II. It also concerns the processes of your data flow diagram from Stage III.

For example, the apps authentication system could be attacked with a virus. Authentication could also be attacked if a threat actor social engineers an employee.

In the **Stage IV** row of the PASTA worksheet, list **2 types** of threats that are risks to the information being handled by the sneaker company's app.

**Pro tip**: Internal system logs that you will use as a security analyst are good sources of threat intel

#### Step 5: List vulnerabilities that can be exploited by those threats

Stage V of PASTA is the vulnerability analysis. Here, you need to consider the attack surface of the technologies listed in Stage II.

For example, the app will use a payment system. The form used to collect credit card information might be vulnerable if it fails to encrypt data.

In **Stage V** of the **PASTA worksheet**, list **2 types** of vulnerabilities that could be exploited.

**Pro tip**: Resources like the [CVE® list](https://cve.mitre.org/cve/search_cve_list.html) and [OWASP](https://owasp.org/www-community/vulnerabilities/) are useful for finding common software vulnerabilities.

#### Step 6: Map assets, threats, and vulnerabilities to an attack tree

In Stage VI of PASTA, the information gathered in the previous two steps are used to build an attack tree.

Open the **PASTA attack tree** resource. Review the diagram and consider how threat actors can potentially exploit these attack vectors.

**Note**: Applications like this normally have large, complex attack trees with many branches.

#### Step 7: Identify new security controls that can reduce risk

PASTA threat modeling is commonly used to reduce the likelihood of security risks. In Stage VII, the final goal is to implement defenses and safeguards that mitigate threats.

In **Stage VII** of the **PASTA worksheet**, list **4 security controls** that you have learned about that can reduce the chances of a security incident, like a data breach.

### What to Include in Your Response

Be sure to address the following elements in your completed activity:

- **2-3** business objectives
- **2-3** technology requirements
- **2** potential threats
- **2** system vulnerabilities
- **4** defenses that limit risk

## Activity Exemplar

To review the exemplar for this course item, click the link and select Use Template.

Link to exemplar: [PASTA worksheet exemplar](https://docs.google.com/document/d/1AKtzaOKIPDGaq3yV9asSkdCsW_q2UYuS_6VQz6NWZsc/template/preview#heading=h.7nlk2ynsm6vx)

Compare the exemplar to your completed activity. Review your work using each of the criteria in the exemplar. What did you do well? Where can you improve? Use your answers to these questions to guide you as you continue to progress through the course.

**Note**: The exemplar represents one possible way to complete the activity. Yours will likely differ in certain ways. What’s important is that your activity includes information at each stage of the process. Threat modeling is an advanced practice in cybersecurity. It normally requires experience in the field, deep knowledge of computer technology, and many different people to participate.

Let’s review each stage of this PASTA threat modeling exercise:

#### Stage I: Define business and security objectives

**Summary**: These objectives are defined early by asking broad questions about the purpose of the application. For example, how does the app make the business money? Understanding the answer to these questions helps guide the detailed work that will follow.

**Recommendations**: A shopping application like this will need to process payments. Based on this description, we know certain technologies are required to keep information private and secure and that everything will need to be compliant with PCI-DSS.

#### Stage II: Define the technical scope

**Summary**: The objective here is to understand the attack surface by identifying the technologies being used by the application and understanding their dependencies.

**Recommendations**: APIs facilitate the exchange of data between customers, partners, and employees, so they should be prioritized. They handle a lot of sensitive data while they connect various users and systems together. However, details such as which APIs are being used should be considered before prioritizing one technology over another. So, they can be more prone to security vulnerabilities because there’s a larger attack surface.

#### Stage III: Decompose the application

**Summary**: Stage three builds upon the previous stage by investigating how the application's components communicate together. The objective here is to review how the application works and how security controls are currently implemented.

**Recommendations**: The sample data flow diagram shows how a typical search request passes through multiple layers. One thing you might review here would be to ensure the MySQL database is using prepared statements when queries are input.

#### Stage IV: Threat analysis

**Summary**: The main objective of stage four is to consider the types of threats that might affect your application. This relates to the technologies you've already scoped. Another thing to consider is the types of data your application will be processing.

**Recommendations**: Injection attacks are common for SQL databases. Session hijacking is possible because the app communicates cookies between multiple layers. It's important to consider your technological attack surface and any relevant threats to your product to effectively implement your information security responsibilities.

#### Stage V: Vulnerability analysis

**Summary**: Stage five is about associating asset vulnerabilities with potential threats. The objective here is to identify what is wrong with the design of the app or its codebase based on your security testing.

**Recommendations**: A lack of prepared statements can make our SQL database vulnerable to injection attacks. And session hijacking is possible if cookies are mishandled between input and output sources.

#### Stage VI: Attack modeling

**Summary**: In this stage, the objective is to link the threats and vulnerabilities identified in the previous steps using attack trees. The purpose of using attack trees here is to show that the potential threats that you've identified are actually viable. Resources like MITRE ATT&CK and the CVE® list are useful references to find evidence that validates the information that you've modeled in your attack tree.

**Recommendations**: This sample attack tree models how user data is vulnerable to the attacks that were identified earlier. Like the sample data flow diagram, an actual attack tree for a mobile application would be much more complex than this.

#### Stage VII: Risk analysis and impact

**Summary**: The objective of the final stage of PASTA is to identify ways to mitigate the risks that were identified from stages IV - VI and plan for any remaining risks that can't be remediated.

**Recommendations**: SHA-256, incident response procedures, password policy, and principle of least privilege are a few examples of technical, operational, and managerial controls that can be implemented before launch to reduce risk.

# Quiz: Module 4 Challenge

## Questions

1. Fill in the blank: The four stages of a social engineering attack are to prepare, **\_**, use persuasion tactics, and disconnect from the target.
   1. distribute malicious email
   2. establish trust
   3. obtain access credentials
   4. perform open-box testing
2. What is the main difference between a vishing attack and a smishing attack?
   1. Vishing is used to target executives at an organization.
   2. Vishing exploits social media posts to identify targets.
   3. Vishing involves a widespread email campaign to steal information.
   4. Vishing makes use of voice calls to trick targets.
3. Fill in the blank: The main difference between a worm and a virus is that a worm can **\_**.
   1. replicate itself across devices without requiring users to perform an action
   2. operate without the target's knowledge
   3. take control of an infected system by encrypting its data
   4. be delivered inside of a legitimate-looking application
4. A government contractor is tricked into installing a virus on their workstation that encrypts all their files. The virus displays a message on the workstation telling the contractor that they can have the files decrypted if they make a payment of $31,337 to an email address. What type of attack is this an example of?
   1. Scareware
   2. Brute force attack
   3. Ransomware
   4. Cross-site scripting
5. Fill in the blank: A(n) **\_** tool can be used by security professionals to catch abnormal activity, like malware mining for cryptocurrency.
   1. Fileless malware
   2. Attack tree
   3. Spyware
   4. Intrusion detection system (IDS)
6. Security researchers inserted malicious code into the web-applications of various organizations. This allowed them to obtain the personally identifiable information (PII) of various users across multiple databases. What type of attack did the researchers perform?
   1. Injection
   2. Ransomware
   3. Input sanitization
   4. Social engineering
7. An attacker sends a malicious link to subscribers of a sports news site. If someone clicks the link, a malicious script is sent to the site's server and activated during the server’s response. This is an example of what type of injection attack?
   1. SQL injection
   2. DOM-based
   3. Reflected
   4. Stored
8. Which of the following are areas of a website that are vulnerable to SQL injection? Select two answers.
   1. Pop-up advertisements
   2. User login pages
   3. Social media feeds
   4. Credit card payment forms
9. A security team is conducting a threat model on a new software system. The team is creating their plan for defending against threats. Their choices are to avoid risk, transfer it, reduce it, or accept it. Which key step of a threat model does this scenario represent?
   1. Define the scope
   2. Mitigate risks
   3. Analyze threats
   4. Evaluate findings
10. Which stage of the PASTA framework is related to identifying the application components that must be evaluated?
    1. Implement prepared statements
    2. Perform a vulnerability analysis
    3. Characterize the environment
    4. Define the technical scope

## Answers

1. 2
2. 4
3. 1
4. 3
5. 4
6. 1
7. 3
8. 2 & 4
9. 2
10. 4
